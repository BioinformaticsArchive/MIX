```{r}
library(data.table)
library(ggplot2)
setwd("~/temp/MIX/")
strsplit2 <- function (x, split, ...) 
{
    x <- as.character(x)
    n <- length(x)
    s <- strsplit(x, split = split, ...)
    nc <- unlist(lapply(s, length))
    out <- matrix("", n, max(nc))
    for (i in 1:n) {
        if (nc[i]) 
            out[i, 1:nc[i]] <- s[[i]]
    }
    out
}


all.gage.b.reports <- c("result_statistics/a_hydrophila_quast/transposed_report.tsv", "result_statistics/V_cholerae_quast/transposed_report.tsv", "result_statistics/B_fragilis_quast/transposed_report.tsv", "result_statistics/X_axonopodis_quast/transposed_report.tsv", "result_statistics/M_abscessus_quast/transposed_report.tsv", "result_statistics/b_cereus_quast/transposed_report.tsv", "result_statistics/aureus_quast/transposed_report.tsv", "result_statistics/rhodo_quast/transposed_report.tsv")

all.quasts<-data.table()
for(file in all.gage.b.reports){
  cat(file,"\n")
  this.report <- fread(file)
  this.specie <- strsplit(file,"/")[[1]][2]
  this.specie <- strsplit(this.specie,"_quast")[[1]][1]
  this.report$specie=this.specie
  this.report$file=file
  all.quasts<-rbind(all.quasts,this.report)
}
all.quasts$specie <- strsplit2(all.quasts$file,"/")[,2]
all.quasts$specie <- sub("_quast","",all.quasts$specie)
all.quasts$merger <- "NA"
all.quasts[grep("mix",Assembly),merger:="MIX",by=Assembly]
all.quasts[grep("GAM",Assembly),merger:="GAM"]

all.quasts[merger=="GAM",assembler.1:=unlist(strsplit(unlist(strsplit(Assembly,"_"))[2],"-"))[1],by=Assembly]
all.quasts[merger=="GAM",assembler.2:=unlist(strsplit(unlist(strsplit(Assembly,"_"))[2],"-"))[2],by=Assembly]
all.quasts[is.na(merger),assembler.1:=unlist(strsplit(Assembly,"_"))[1],by=Assembly]

extract_mix_assembler <- function(s){
  elements <- unlist(strsplit(s,"_"))
  return(elements[elements==toupper(elements)])
}
all.quasts[merger=="MIX",n.assembler:=length(extract_mix_assembler(Assembly)),by=Assembly]
all.quasts.orginal.names <- colnames(all.quasts)
setnames(all.quasts,colnames(all.quasts),make.names(colnames(all.quasts)))
```


```{r}
all.quasts[,max(N50),by=list(specie,merger)]
all.quasts[,max(NA50),by=list(specie,merger)]
```

